require(["gitbook","jquery"],function(s,n){var e,f,t=4,i=0,o=[{config:"white",text:"White",id:0},{config:"sepia",text:"Sepia",id:1},{config:"night",text:"Night",id:2}],a=[{config:"serif",text:"Serif",id:0},{config:"sans",text:"Sans",id:1}];function r(){s.storage.set("fontState",f),h()}function c(e){e.preventDefault(),f.size>=t||(f.size++,r())}function l(e){e.preventDefault(),f.size<=i||(f.size--,r())}function u(e,t){t&&t instanceof Event&&t.preventDefault();var n=g(e);f.family=n,r()}function m(e,t){t&&t instanceof Event&&t.preventDefault();var n=s.state.$book;0!==f.theme&&n.removeClass("color-theme-"+f.theme);var i=d(e);f.theme=i,0!==f.theme&&n.addClass("color-theme-"+f.theme),r()}function g(t){var e=n.grep(a,function(e){return e.config==t})[0];return e?e.id:0}function d(t){var e=n.grep(o,function(e){return e.config==t})[0];return e?e.id:0}function h(){var e=s.state.$book;n(".font-settings .font-family-list li").removeClass("active"),n(".font-settings .font-family-list li:nth-child("+(f.family+1)+")").addClass("active"),e[0].className=e[0].className.replace(/\bfont-\S+/g,""),e.addClass("font-size-"+f.size),e.addClass("font-family-"+f.family),0!==f.theme&&(e[0].className=e[0].className.replace(/\bcolor-theme-\S+/g,""),e.addClass("color-theme-"+f.theme))}function v(){e&&s.toolbar.removeButton(e),e=s.toolbar.createButton({icon:"fa fa-font",label:"Font Settings",className:"font-settings",dropdown:[[{text:"A",className:"font-reduce",onClick:l},{text:"A",className:"font-enlarge",onClick:c}],n.map(a,function(t){return t.onClick=function(e){return u(t.config,e)},t}),n.map(o,function(t){return t.onClick=function(e){return m(t.config,e)},t})]})}s.events.bind("start",function(e,t){var n,i,o,a=t.fontsettings;v(),i=g((n=a).family),o=d(n.theme),f=s.storage.get("fontState",{size:n.size||2,family:i,theme:o}),h()}),s.fontsettings={enlargeFontSize:c,reduceFontSize:l,setTheme:m,setFamily:u,getThemes:function(){return o},setThemes:function(e){o=e,v()},getFamilies:function(){return a},setFamilies:function(e){a=e,v()}}});